{% macro inspection_info(inspection, i=1) -%}

      <div class="accordion-group">
        <div class="accordion-heading">
          <div style="
                  {% if inspection.results == "Pass" %}
                    background-image:-webkit-gradient(linear, 100% 82%, 100% 100%, from(#FFFFFF), to(#BAFFB5));
                    background-image:-moz-linear-gradient(81% 82% 270deg,#FFFFFF, #BAFFB5);
                    background: #BAFFB5;
                  {% elif inspection.results == "Fail" %}
                    background-image: -webkit-gradient(linear, 0% 82%, 0% 100%, from(#FFFFFF), to(#C23C3C));
                    background-image: -moz-linear-gradient(81% 82% 270deg,#FFFFFF, #C23C3C);
                    background: #C23C3C;
                  {% else %}
                    background-image: -webkit-gradient(linear, 0% 82%, 0% 100%, from(#FFFFFF), to(#FF7E29));
                    background-image: -moz-linear-gradient(81% 82% 270deg,#FFFFFF, #FF7E29);
                    background: #FF7E29;
                  {% endif %}
                  ">
            <a class="text-center accordion-toggle title-link" data-toggle="collapse" data-parent="#accordion{{i}}" href="#collapse{{i}}"><i class="icon-arrow-down icon-right">  </i>   &nbsp;&nbsp;&nbsp;&nbsp;
                  {% if inspection.results == "Pass" %}
                      <i class="icon-thumbs-up"></i>Passed on
                  {% elif inspection.results == "Fail" %}
                  <i class="icon-thumbs-down"></i> Failed on
                  {% endif %}Inspected on {{inspection.inspection_date.month}} {{inspection.inspection_date.day}} {{inspection.inspection_date.year}}
                  <span class="badge pull-right badge-important" id="tallyCriticalTop{{i}}"></span>&nbsp;
                  <span class="badge pull-right badge-warning" id="tallySeriousTop{{i}}"></span>&nbsp;
                  <span class="badge pull-right" id="tallyMinorTop{{i}}"></span>&nbsp;
                  {% if inspection.comments %}
                      <i class="icon-comment"></i>
                  {% endif %}
            </a>
          </div>
        </div>
        <div id="collapse{{i}}" class="accordion-body collapse">
          <div class="accordion-inner">
            <ul class="inspection-data">
              <li><p>Inspection Type: {{ inspection.inspection_type }}</p></li>
            {% if inspection.comments %}
                {{ inspection_comments(inspection.comments, i) }}
            {% endif %}
            {% if inspection.violations %}
                {{ violations(inspection.violations, i) }}
            {% endif %}

            </ul>
          </div>
        </div>
      </div>

{%- endmacro %}

{% macro inspection_comments(comments, i=1) -%}



  <div class="accordion-group">
    <div class="accordion-heading">
      <a class="accordion-toggle title-link" data-toggle="collapse" data-parent="#accordion{{i}}" href="#collapseComments{{i}}">
        Comments <i class="icon-comment"></i><i class="icon-arrow-down icon-right"></i>
      </a>
    </div>
    <div id="collapseComments{{i}}" class="accordion-body collapse">
      <div class="accordion-inner">
          <ul class="inspection-data">
              {% if comments %}
              {% for comment in comments %}
              <li><p>{{ comment.comment }}</p></li>
              {% endfor %}
              {% endif %}
          </ul>
      </div>
    </div>
  </div>

{%- endmacro %}

{% macro violations(violations, i=1) -%}
    <div class="container" id="violations-container{{i}}">
      <ul class="nav nav-tabs">
        <li class="level active"><a data-level="#Critical{{i}}"><span id="tallyCritical{{i}}" class="badge badge-important"></span> Critical Violations</a></li>
          
        <li class="level"><a data-level="#Serious{{i}}" ><span id="tallySerious{{i}}" class="badge badge-warning"></span> Serious Violations</a></li>
        
        <li class="level"><a data-level="#Minor{{i}}"><span class="badge" id="tallyMinor{{i}}"></span> Minor Violations</a></li>
      </ul>
      <div id="Critical{{i}}">
        {% for violation in violations %}
        {% if violation.violation_number <= 14 %}
        <a href="{{ url_for('violations_blueprint.show_single_violation', violation_number=violation.violation_number) }}"><p class="critical-violation{{i}}">{{ violation.violation_number }}. {{ violation.details }}</p></a>
        {% endif %}
        {% endfor %}
      </div>

      <div class="not-displayed" id="Serious{{i}}">
        {% for violation in violations %}
        {% if violation.violation_number >= 15 and violation.violation_number <= 29 %}
        <a href="{{ url_for('violations_blueprint.show_single_violation', violation_number=violation.violation_number) }}"><p class='serious-violation{{i}}'>{{ violation.violation_number }}. {{ violation.details }}</p></a>
        {% endif %}
        {% endfor %}
      </div>

      <div class="not-displayed" id="Minor{{i}}">
        {% for violation in violations %}
        {% if violation.violation_number >= 30 %}
        <a href="{{ url_for('violations_blueprint.show_single_violation', violation_number=violation.violation_number) }}"><p class="minor-violation{{i}}">{{ violation.violation_number }}. {{ violation.details }}</p></a>
        {% endif %}
        {% endfor %}
      </div>
    </div>


    <script>
          var tally = function(classSelector, outputIdSelector){
              $(outputIdSelector).text($(classSelector).length);
          }

          tally(".minor-violation{{i}}", "#tallyMinor{{i}}");
          tally(".serious-violation{{i}}", "#tallySerious{{i}}");
          tally(".critical-violation{{i}}", "#tallyCritical{{i}}");
          tally(".minor-violation{{i}}", "#tallyMinorTop{{i}}");
          tally(".serious-violation{{i}}", "#tallySeriousTop{{i}}");
          tally(".critical-violation{{i}}", "#tallyCriticalTop{{i}}");

    </script>
    <script>
        $(document).ready(function(){
          $('.level').click(function(clicked){
            var unWantedLevel = $('.active').children('a').attr('data-level');
            $(unWantedLevel).addClass('not-displayed');
            var wantedLevel = $(this).children('a').attr('data-level');
            $(wantedLevel).removeClass('not-displayed');

            $('.active').removeClass('active');
            $(this).addClass('active');
          });
        });
    </script>

{%- endmacro %}

{% macro inspection(inspection, i) -%}

    {{ inspection_info(inspection, i) }}

{%- endmacro %}
